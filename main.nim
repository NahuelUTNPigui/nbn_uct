import nbn2
proc main()=
    let dummies = 18
    #UN intento de tateti
    let config  = @[
        @[18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],
        @[19,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],
        @[20,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],
        @[21,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],
        @[22,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],
        @[23,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],
        @[24,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],
        @[25,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],
        @[26,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],
        @[27,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],
        @[28,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],
        @[29,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],
        @[30,29,28,27,26,25,24,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],
        @[31,29,28,27,26,25,24,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],
        @[32,29,28,27,26,25,24,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],
    ]
    let out_neurons= @[32,31,30]
    let inputs = @[
        @[1.0,0,0,0,1,0,0,0,1 ,0,1,1,1,0,0,0,0,0],
        @[1.0,0,1,0,0,0,0,0,1 ,0,1,0,0,1,0,0,1,0],
        @[1.0,0,1,0,1,0,0,1,0 ,0,1,0,1,0,1,1,0,1],
        @[0.0,0,1,0,1,0,1,0,0 ,1,1,0,1,0,0,0,0,0],
        @[1.0,0,0,1,0,1,0,0,0 ,0,0,1,0,0,0,1,0,1],
        @[1.0,0,0,1,0,1,0,0,0 ,0,1,0,0,1,0,0,1,0],
    ]
    let outputs = @[
        @[1.0,0,0],
        @[0.0,0,1],
        @[0.0,1,0],
        @[1.0,0,0],
        @[0.0,1,0],
        @[0.0,0,1]
    ]
    var red = newRedNBN2(dummies,config,out_neurons)
    var iteraciones = 500
    let alfa = 0.9
    let max_error=0.001
    echo "GR"
    let err = red.learn_ce(iteraciones,alfa,max_error,inputs,outputs)
    echo "El error: " & $err
    var i = 0 
    
    for inp in inputs:
        echo "Esperado"
        echo outputs[i]
        echo "Real"
        echo red.predict_argmax(inp)
        i += 1

main()